) {
g_e0 <- sample(
x=c(0, 1, 2),
size=n_e0,
prob=c((1 - maf_e0) ^ 2, 2 * maf_e0 * (1 - maf_e0), maf_e0 ^ 2),
replace = TRUE
)
g_e1 <- sample(
x=c(0, 1, 2),
size=n_e1,
prob=c((1 - maf_e1) ^ 2, 2 * maf_e1 * (1 - maf_e1), maf_e1 ^ 2),
replace = TRUE
)
y_e0 <- g_e0 * fx_e0 + rnorm(n = n_e0, sd = sigma_e0)
y_e1 <- g_e1 * fx_e1 + rnorm(n = n_e1, sd = sigma_e1)
sim_df <- data.frame(
y = c(y_e0, y_e1),
g = c(g_e0, g_e1),
e = c(rep("e0", n_e0), rep("e1", n_e1))
)
return(sim_df)
}
simulate_mse_avg_genetic_effect_two_env <- function(
n_e0_grid,
n_e1_grid,
fx_e0_grid,
fx_e1_grid,
sigma_e0_grid,
sigma_e1_grid,
maf_e0_grid,
maf_e1_grid,
sims_per_grid_pt = 50
) {
grid_variables_list <- list(
n_e0 = n_e0_grid,
n_e1 = n_e1_grid,
fx_e0 = fx_e0_grid,
fx_e1 = fx_e1_grid,
sigma_e0 = sigma_e0_grid,
sigma_e1 = sigma_e1_grid,
maf_e0 = maf_e0_grid,
maf_e1 = maf_e1_grid
)
sim_grid <- expand.grid(grid_variables_list)
mse_comb_vec_avg <- numeric(nrow(sim_grid))
mse_sep_vec_avg <- numeric(nrow(sim_grid))
mse_comb_vec_e0 <- numeric(nrow(sim_grid))
mse_sep_vec_e0 <- numeric(nrow(sim_grid))
mse_comb_vec_e1 <- numeric(nrow(sim_grid))
mse_sep_vec_e1 <- numeric(nrow(sim_grid))
for (i in 1:nrow(sim_grid)) {
prop_e0 <- sim_grid$n_e0[i] / (sim_grid$n_e0[i] + sim_grid$n_e1[i])
avg_genetic_effect <- prop_e0 * sim_grid$fx_e0[i] + (1 - prop_e0) * sim_grid$fx_e1[i]
sim_mse_comb_vec_avg <- numeric(sims_per_grid_pt)
sim_mse_sep_vec_avg <- numeric(sims_per_grid_pt)
sim_mse_comb_vec_e0 <- numeric(sims_per_grid_pt)
sim_mse_sep_vec_e0 <- numeric(sims_per_grid_pt)
sim_mse_comb_vec_e1 <- numeric(sims_per_grid_pt)
sim_mse_sep_vec_e1 <- numeric(sims_per_grid_pt)
for (j in 1:sims_per_grid_pt) {
sim_df <- simulate_two_env_df(
n_e0 = sim_grid$n_e0[i],
n_e1 = sim_grid$n_e1[i],
sigma_e0 = sim_grid$sigma_e0[i],
sigma_e1 = sim_grid$sigma_e1[i],
fx_e0 = sim_grid$fx_e0[i],
fx_e1 = sim_grid$fx_e1[i],
maf_e0 = sim_grid$maf_e0[i],
maf_e1 = sim_grid$maf_e1[i]
)
lm_comb <- lm(y ~ g, data = sim_df)
g_est_comb <- coef(summary(lm_comb))['g', 'Estimate']
lm_e0 <- lm(y ~ g, data = sim_df, subset = (e == "e0"))
g_e0_est <- coef(summary(lm_e0))['g', 'Estimate']
lm_e1 <- lm(y ~ g, data = sim_df, subset = (e == "e1"))
g_e1_est <- coef(summary(lm_e1))['g', 'Estimate']
sep_avg_genetic_effect_est <- prop_e0 * g_e0_est + (1 - prop_e0) * g_e1_est
mse_comb_avg <- (avg_genetic_effect - g_est_comb) ^ 2
mse_sep_avg <- (avg_genetic_effect - sep_avg_genetic_effect_est) ^ 2
mse_sep_e0 <- (sim_grid$fx_e0[i] - g_e0_est) ^ 2
mse_sep_e1 <- (sim_grid$fx_e1[i] - g_e1_est) ^ 2
mse_comb_e0 <- (sim_grid$fx_e0[i] - g_est_comb) ^ 2
mse_comb_e1 <- (sim_grid$fx_e1[i] - g_est_comb) ^ 2
sim_mse_comb_vec_avg[j] <- mse_comb_avg
sim_mse_sep_vec_avg[j] <- mse_sep_avg
sim_mse_comb_vec_e0[j] <- mse_comb_e0
sim_mse_sep_vec_e0[j] <- mse_sep_e0
sim_mse_comb_vec_e1[j] <- mse_comb_e1
sim_mse_sep_vec_e1[j] <- mse_sep_e1
}
mse_comb_vec_avg[i] <- mean(sim_mse_comb_vec_avg)
mse_sep_vec_avg[i] <- mean(sim_mse_sep_vec_avg)
mse_comb_vec_e0[i] <- mean(sim_mse_comb_vec_e0)
mse_sep_vec_e0[i] <- mean(sim_mse_sep_vec_e0)
mse_comb_vec_e1[i] <- mean(sim_mse_comb_vec_e1)
mse_sep_vec_e1[i] <- mean(sim_mse_sep_vec_e1)
}
sim_grid$mse_comb_avg <- mse_comb_vec_avg
sim_grid$mse_sep_avg <- mse_sep_vec_avg
sim_grid$mse_comb_e0 <- mse_comb_vec_e0
sim_grid$mse_comb_e1 <- mse_comb_vec_e1
sim_grid$mse_sep_e0 <- mse_sep_vec_e0
sim_grid$mse_sep_e1 <- mse_sep_vec_e1
return(sim_grid)
}
maf_diff_sim <- simulate_mse_avg_genetic_effect_two_env(
n_e0_grid = c(1000),
n_e1_grid = c(1000),
fx_e0_grid = c(1),
fx_e1_grid = c(0),
sigma_e0_grid = c(1),
sigma_e1_grid = c(1),
maf_e0_grid = c(.45),
maf_e1_grid = c(.05, .1, .15, .2, .25, .3, .35, .4, .45),
sims_per_grid_pt = 1000
)
maf_diff_sim_long <- maf_diff_sim %>% tidyr::pivot_longer(cols = c("mse_comb_avg", "mse_sep_avg", "mse_comb_e0", "mse_comb_e1", "mse_sep_e0", "mse_sep_e1"), names_to = "metric", values_to = "mse")
comb_model_data <- maf_diff_sim_long %>%
dplyr::filter(metric %in% c("mse_comb_avg", "mse_comb_e0", "mse_comb_e1"))
sep_model_data <- maf_diff_sim_long %>%
dplyr::filter(metric %in% c("mse_sep_avg", "mse_sep_e0", "mse_sep_e1"))
comb_plot <- ggplot(data = comb_model_data, aes(x = maf_e1, y = mse)) +
geom_point(aes(color = metric)) +
geom_line(aes(color = metric))
sep_plot <- ggplot(data = sep_model_data, aes(x = maf_e1, y = mse)) +
geom_point(aes(color = metric)) +
geom_line(aes(color = metric))
gridExtra::grid.arrange(comb_plot, sep_plot, nrow=2)
fx_diff_sim <- simulate_mse_avg_genetic_effect_two_env(
n_e0_grid = c(1000),
n_e1_grid = c(1000),
fx_e1_grid = c(0, .1, 1, 2.5, 5, 10),
fx_e0_grid = c(0),
sigma_e0_grid = c(1),
sigma_e1_grid = c(1),
maf_e0_grid = c(.45),
maf_e1_grid = c(.45),
sims_per_grid_pt = 1000
)
fx_diff_sim_long <- fx_diff_sim %>% tidyr::pivot_longer(cols = c("mse_comb_avg", "mse_sep_avg", "mse_comb_e0", "mse_comb_e1", "mse_sep_e0", "mse_sep_e1"), names_to = "metric", values_to = "mse")
comb_model_data <- fx_diff_sim_long %>%
dplyr::filter(metric %in% c("mse_comb_avg", "mse_comb_e0", "mse_comb_e1"))
sep_model_data <- fx_diff_sim_long %>%
dplyr::filter(metric %in% c("mse_sep_avg", "mse_sep_e0", "mse_sep_e1"))
comb_plot <- ggplot(data = comb_model_data, aes(x = fx_e1, y = mse)) +
geom_point(aes(color = metric)) +
geom_line(aes(color = metric))
sep_plot <- ggplot(data = sep_model_data, aes(x = fx_e1, y = mse)) +
geom_point(aes(color = metric)) +
geom_line(aes(color = metric))
gridExtra::grid.arrange(comb_plot, sep_plot, nrow=2)
View(comb_model_data)
View(comb_model_data)
fx_diff_sim <- simulate_mse_avg_genetic_effect_two_env(
n_e0_grid = c(1000),
n_e1_grid = c(1000),
fx_e1_grid = c(0, .1, 1, 2.5, 5),
fx_e0_grid = c(0),
sigma_e0_grid = c(sqrt(5)),
sigma_e1_grid = c(sqrt(5)),
maf_e0_grid = c(.45),
maf_e1_grid = c(.45),
sims_per_grid_pt = 1000
)
fx_diff_sim_long <- fx_diff_sim %>% tidyr::pivot_longer(cols = c("mse_comb_avg", "mse_sep_avg", "mse_comb_e0", "mse_comb_e1", "mse_sep_e0", "mse_sep_e1"), names_to = "metric", values_to = "mse")
comb_model_data <- fx_diff_sim_long %>%
dplyr::filter(metric %in% c("mse_comb_avg", "mse_comb_e0", "mse_comb_e1"))
sep_model_data <- fx_diff_sim_long %>%
dplyr::filter(metric %in% c("mse_sep_avg", "mse_sep_e0", "mse_sep_e1"))
comb_plot <- ggplot(data = comb_model_data, aes(x = fx_e1, y = mse)) +
geom_point(aes(color = metric)) +
geom_line(aes(color = metric))
sep_plot <- ggplot(data = sep_model_data, aes(x = fx_e1, y = mse)) +
geom_point(aes(color = metric)) +
geom_line(aes(color = metric))
gridExtra::grid.arrange(comb_plot, sep_plot, nrow=2)
fx_diff_sim <- simulate_mse_avg_genetic_effect_two_env(
n_e0_grid = c(1000),
n_e1_grid = c(1000),
fx_e1_grid = c(0, .1, .2, .3, .4, .5, 1, 2),
fx_e0_grid = c(0),
sigma_e0_grid = c(sqrt(5)),
sigma_e1_grid = c(sqrt(5)),
maf_e0_grid = c(.45),
maf_e1_grid = c(.45),
sims_per_grid_pt = 1000
)
fx_diff_sim_long <- fx_diff_sim %>% tidyr::pivot_longer(cols = c("mse_comb_avg", "mse_sep_avg", "mse_comb_e0", "mse_comb_e1", "mse_sep_e0", "mse_sep_e1"), names_to = "metric", values_to = "mse")
comb_model_data <- fx_diff_sim_long %>%
dplyr::filter(metric %in% c("mse_comb_avg", "mse_comb_e0", "mse_comb_e1"))
sep_model_data <- fx_diff_sim_long %>%
dplyr::filter(metric %in% c("mse_sep_avg", "mse_sep_e0", "mse_sep_e1"))
comb_plot <- ggplot(data = comb_model_data, aes(x = fx_e1, y = mse)) +
geom_point(aes(color = metric)) +
geom_line(aes(color = metric))
sep_plot <- ggplot(data = sep_model_data, aes(x = fx_e1, y = mse)) +
geom_point(aes(color = metric)) +
geom_line(aes(color = metric))
gridExtra::grid.arrange(comb_plot, sep_plot, nrow=2)
View(fx_diff_sim_long)
fx_diff_sim <- simulate_mse_avg_genetic_effect_two_env(
n_e0_grid = c(1000),
n_e1_grid = c(1000),
fx_e1_grid = c(0, .1, .2, .3, .4, .5, .6, .7, .8, .9, 1),
fx_e0_grid = c(0),
sigma_e0_grid = c(sqrt(5)),
sigma_e1_grid = c(sqrt(5)),
maf_e0_grid = c(.45),
maf_e1_grid = c(.45),
sims_per_grid_pt = 1000
)
fx_diff_sim_long <- fx_diff_sim %>% tidyr::pivot_longer(cols = c("mse_comb_avg", "mse_sep_avg", "mse_comb_e0", "mse_comb_e1", "mse_sep_e0", "mse_sep_e1"), names_to = "metric", values_to = "mse")
comb_model_data <- fx_diff_sim_long %>%
dplyr::filter(metric %in% c("mse_comb_avg", "mse_comb_e0", "mse_comb_e1"))
sep_model_data <- fx_diff_sim_long %>%
dplyr::filter(metric %in% c("mse_sep_avg", "mse_sep_e0", "mse_sep_e1"))
comb_plot <- ggplot(data = comb_model_data, aes(x = fx_e1, y = mse)) +
geom_point(aes(color = metric)) +
geom_line(aes(color = metric))
sep_plot <- ggplot(data = sep_model_data, aes(x = fx_e1, y = mse)) +
geom_point(aes(color = metric)) +
geom_line(aes(color = metric))
gridExtra::grid.arrange(comb_plot, sep_plot, nrow=2)
sd_diff_sim <- simulate_mse_avg_genetic_effect_two_env(
n_e0_grid = c(1000),
n_e1_grid = c(1000),
fx_e1_grid = c(0),
fx_e0_grid = c(0),
sigma_e0_grid = c(1),
sigma_e1_grid = c(.1, .25, .5, 1, 1.25, 1.5, 2),
maf_e0_grid = c(.45),
maf_e1_grid = c(.45),
sims_per_grid_pt = 1000
)
sd_diff_sim_long <- sd_diff_sim %>% tidyr::pivot_longer(cols = c("mse_comb_avg", "mse_sep_avg", "mse_comb_e0", "mse_comb_e1", "mse_sep_e0", "mse_sep_e1"), names_to = "metric", values_to = "mse")
comb_model_data <- sd_diff_sim_long %>%
dplyr::filter(metric %in% c("mse_comb_avg", "mse_comb_e0", "mse_comb_e1"))
sep_model_data <- sd_diff_sim_long %>%
dplyr::filter(metric %in% c("mse_sep_avg", "mse_sep_e0", "mse_sep_e1"))
comb_plot <- ggplot(data = comb_model_data, aes(x = sigma_e1, y = mse)) +
geom_point(aes(color = metric)) +
geom_line(aes(color = metric))
sep_plot <- ggplot(data = sep_model_data, aes(x = sigma_e1, y = mse)) +
geom_point(aes(color = metric)) +
geom_line(aes(color = metric))
gridExtra::grid.arrange(comb_plot, sep_plot, nrow=2)
View(comb_model_data)
knitr::opts_chunk$set(echo = TRUE)
set.seed(1)
'%>%' <- dplyr::'%>%'
library(ggplot2)
simulate_two_env_df <- function(
n_e0,
n_e1,
sigma_e0,
sigma_e1,
fx_e0,
fx_e1,
maf_e0 = .4,
maf_e1 = .4
) {
g_e0 <- sample(
x=c(0, 1, 2),
size=n_e0,
prob=c((1 - maf_e0) ^ 2, 2 * maf_e0 * (1 - maf_e0), maf_e0 ^ 2),
replace = TRUE
)
g_e1 <- sample(
x=c(0, 1, 2),
size=n_e1,
prob=c((1 - maf_e1) ^ 2, 2 * maf_e1 * (1 - maf_e1), maf_e1 ^ 2),
replace = TRUE
)
y_e0 <- g_e0 * fx_e0 + rnorm(n = n_e0, sd = sigma_e0)
y_e1 <- g_e1 * fx_e1 + rnorm(n = n_e1, sd = sigma_e1)
sim_df <- data.frame(
y = c(y_e0, y_e1),
g = c(g_e0, g_e1),
e = c(rep("e0", n_e0), rep("e1", n_e1))
)
return(sim_df)
}
simulate_mse_avg_genetic_effect_two_env <- function(
n_e0_grid,
n_e1_grid,
fx_e0_grid,
fx_e1_grid,
sigma_e0_grid,
sigma_e1_grid,
maf_e0_grid,
maf_e1_grid,
sims_per_grid_pt = 50
) {
grid_variables_list <- list(
n_e0 = n_e0_grid,
n_e1 = n_e1_grid,
fx_e0 = fx_e0_grid,
fx_e1 = fx_e1_grid,
sigma_e0 = sigma_e0_grid,
sigma_e1 = sigma_e1_grid,
maf_e0 = maf_e0_grid,
maf_e1 = maf_e1_grid
)
sim_grid <- expand.grid(grid_variables_list)
mse_comb_vec_avg <- numeric(nrow(sim_grid))
mse_sep_vec_avg <- numeric(nrow(sim_grid))
mse_comb_vec_e0 <- numeric(nrow(sim_grid))
mse_sep_vec_e0 <- numeric(nrow(sim_grid))
mse_comb_vec_e1 <- numeric(nrow(sim_grid))
mse_sep_vec_e1 <- numeric(nrow(sim_grid))
for (i in 1:nrow(sim_grid)) {
prop_e0 <- sim_grid$n_e0[i] / (sim_grid$n_e0[i] + sim_grid$n_e1[i])
avg_genetic_effect <- prop_e0 * sim_grid$fx_e0[i] + (1 - prop_e0) * sim_grid$fx_e1[i]
sim_mse_comb_vec_avg <- numeric(sims_per_grid_pt)
sim_mse_sep_vec_avg <- numeric(sims_per_grid_pt)
sim_mse_comb_vec_e0 <- numeric(sims_per_grid_pt)
sim_mse_sep_vec_e0 <- numeric(sims_per_grid_pt)
sim_mse_comb_vec_e1 <- numeric(sims_per_grid_pt)
sim_mse_sep_vec_e1 <- numeric(sims_per_grid_pt)
for (j in 1:sims_per_grid_pt) {
sim_df <- simulate_two_env_df(
n_e0 = sim_grid$n_e0[i],
n_e1 = sim_grid$n_e1[i],
sigma_e0 = sim_grid$sigma_e0[i],
sigma_e1 = sim_grid$sigma_e1[i],
fx_e0 = sim_grid$fx_e0[i],
fx_e1 = sim_grid$fx_e1[i],
maf_e0 = sim_grid$maf_e0[i],
maf_e1 = sim_grid$maf_e1[i]
)
lm_comb <- lm(y ~ g, data = sim_df)
g_est_comb <- coef(summary(lm_comb))['g', 'Estimate']
lm_e0 <- lm(y ~ g, data = sim_df, subset = (e == "e0"))
g_e0_est <- coef(summary(lm_e0))['g', 'Estimate']
lm_e1 <- lm(y ~ g, data = sim_df, subset = (e == "e1"))
g_e1_est <- coef(summary(lm_e1))['g', 'Estimate']
sep_avg_genetic_effect_est <- prop_e0 * g_e0_est + (1 - prop_e0) * g_e1_est
mse_comb_avg <- (avg_genetic_effect - g_est_comb) ^ 2
mse_sep_avg <- (avg_genetic_effect - sep_avg_genetic_effect_est) ^ 2
mse_sep_e0 <- (sim_grid$fx_e0[i] - g_e0_est) ^ 2
mse_sep_e1 <- (sim_grid$fx_e1[i] - g_e1_est) ^ 2
mse_comb_e0 <- (sim_grid$fx_e0[i] - g_est_comb) ^ 2
mse_comb_e1 <- (sim_grid$fx_e1[i] - g_est_comb) ^ 2
sim_mse_comb_vec_avg[j] <- mse_comb_avg
sim_mse_sep_vec_avg[j] <- mse_sep_avg
sim_mse_comb_vec_e0[j] <- mse_comb_e0
sim_mse_sep_vec_e0[j] <- mse_sep_e0
sim_mse_comb_vec_e1[j] <- mse_comb_e1
sim_mse_sep_vec_e1[j] <- mse_sep_e1
}
mse_comb_vec_avg[i] <- mean(sim_mse_comb_vec_avg)
mse_sep_vec_avg[i] <- mean(sim_mse_sep_vec_avg)
mse_comb_vec_e0[i] <- mean(sim_mse_comb_vec_e0)
mse_sep_vec_e0[i] <- mean(sim_mse_sep_vec_e0)
mse_comb_vec_e1[i] <- mean(sim_mse_comb_vec_e1)
mse_sep_vec_e1[i] <- mean(sim_mse_sep_vec_e1)
}
sim_grid$mse_comb_avg <- mse_comb_vec_avg
sim_grid$mse_sep_avg <- mse_sep_vec_avg
sim_grid$mse_comb_e0 <- mse_comb_vec_e0
sim_grid$mse_comb_e1 <- mse_comb_vec_e1
sim_grid$mse_sep_e0 <- mse_sep_vec_e0
sim_grid$mse_sep_e1 <- mse_sep_vec_e1
return(sim_grid)
}
maf_diff_sim <- simulate_mse_avg_genetic_effect_two_env(
n_e0_grid = c(1000),
n_e1_grid = c(1000),
fx_e0_grid = c(1),
fx_e1_grid = c(0),
sigma_e0_grid = c(1),
sigma_e1_grid = c(1),
maf_e0_grid = c(.45),
maf_e1_grid = c(.05, .1, .15, .2, .25, .3, .35, .4, .45),
sims_per_grid_pt = 1000
)
maf_diff_sim_long <- maf_diff_sim %>% tidyr::pivot_longer(cols = c("mse_comb_avg", "mse_sep_avg", "mse_comb_e0", "mse_comb_e1", "mse_sep_e0", "mse_sep_e1"), names_to = "metric", values_to = "mse")
comb_model_data <- maf_diff_sim_long %>%
dplyr::filter(metric %in% c("mse_comb_avg", "mse_comb_e0", "mse_comb_e1"))
sep_model_data <- maf_diff_sim_long %>%
dplyr::filter(metric %in% c("mse_sep_avg", "mse_sep_e0", "mse_sep_e1"))
comb_plot <- ggplot(data = comb_model_data, aes(x = maf_e1, y = mse)) +
geom_point(aes(color = metric)) +
geom_line(aes(color = metric))
sep_plot <- ggplot(data = sep_model_data, aes(x = maf_e1, y = mse)) +
geom_point(aes(color = metric)) +
geom_line(aes(color = metric))
gridExtra::grid.arrange(comb_plot, sep_plot, nrow=2)
fx_diff_sim <- simulate_mse_avg_genetic_effect_two_env(
n_e0_grid = c(1000),
n_e1_grid = c(1000),
fx_e1_grid = c(0, .1, .2, .3, .4, .5, .6, .7, .8, .9, 1),
fx_e0_grid = c(0),
sigma_e0_grid = c(sqrt(5)),
sigma_e1_grid = c(sqrt(5)),
maf_e0_grid = c(.45),
maf_e1_grid = c(.45),
sims_per_grid_pt = 1000
)
fx_diff_sim_long <- fx_diff_sim %>% tidyr::pivot_longer(cols = c("mse_comb_avg", "mse_sep_avg", "mse_comb_e0", "mse_comb_e1", "mse_sep_e0", "mse_sep_e1"), names_to = "metric", values_to = "mse")
comb_model_data <- fx_diff_sim_long %>%
dplyr::filter(metric %in% c("mse_comb_avg", "mse_comb_e0", "mse_comb_e1"))
sep_model_data <- fx_diff_sim_long %>%
dplyr::filter(metric %in% c("mse_sep_avg", "mse_sep_e0", "mse_sep_e1"))
comb_plot <- ggplot(data = comb_model_data, aes(x = fx_e1, y = mse)) +
geom_point(aes(color = metric)) +
geom_line(aes(color = metric))
sep_plot <- ggplot(data = sep_model_data, aes(x = fx_e1, y = mse)) +
geom_point(aes(color = metric)) +
geom_line(aes(color = metric))
gridExtra::grid.arrange(comb_plot, sep_plot, nrow=2)
sd_diff_sim <- simulate_mse_avg_genetic_effect_two_env(
n_e0_grid = c(1000),
n_e1_grid = c(1000),
fx_e1_grid = c(0),
fx_e0_grid = c(0),
sigma_e0_grid = c(1),
sigma_e1_grid = c(.1, .25, .5, 1, 1.25, 1.5, 2),
maf_e0_grid = c(.45),
maf_e1_grid = c(.45),
sims_per_grid_pt = 1000
)
sd_diff_sim_long <- sd_diff_sim %>% tidyr::pivot_longer(cols = c("mse_comb_avg", "mse_sep_avg", "mse_comb_e0", "mse_comb_e1", "mse_sep_e0", "mse_sep_e1"), names_to = "metric", values_to = "mse")
comb_model_data <- sd_diff_sim_long %>%
dplyr::filter(metric %in% c("mse_comb_avg", "mse_comb_e0", "mse_comb_e1"))
sep_model_data <- sd_diff_sim_long %>%
dplyr::filter(metric %in% c("mse_sep_avg", "mse_sep_e0", "mse_sep_e1"))
comb_plot <- ggplot(data = comb_model_data, aes(x = sigma_e1, y = mse)) +
geom_point(aes(color = metric)) +
geom_line(aes(color = metric))
sep_plot <- ggplot(data = sep_model_data, aes(x = sigma_e1, y = mse)) +
geom_point(aes(color = metric)) +
geom_line(aes(color = metric))
gridExtra::grid.arrange(comb_plot, sep_plot, nrow=2)
comb_plot <- ggplot(data = comb_model_data, aes(x = sigma_e1, y = mse)) +
geom_point(aes(color = metric)) +
geom_line(aes(color = metric))
sep_plot <- ggplot(data = sep_model_data, aes(x = sigma_e1, y = mse)) +
geom_point(aes(color = metric)) +
geom_line(aes(color = metric))
gridExtra::grid.arrange(comb_plot, sep_plot, nrow=2)
View(comb_model_data)
matrix(data = c(.2, .2, .6, 0, .2, .5, .1, .2, 0, 0, 1, 0, 0, 0, 0, 1), nrow = 4)
matrixcalc::matrix.power(matrix(data = c(.2, .2, .6, 0, .2, .5, .1, .2, 0, 0, 1, 0, 0, 0, 0, 1), nrow = 4), 1000)
mat <- .Last.value
mat
mat %*% matrix(data = c(.3, .7, 0, 0), nrow = 4)
59 / 90
31 / 90
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
vignette("intro", "flashier")
help(flash)
source("~/.active-rstudio-document")
setwd("~/Documents/academic/MASHvFLASH/scratch")
source("~/Documents/academic/MASHvFLASH/scratch/mash_flash_prep.R")
install_github("stephenslab/flashr")
devtools::install_github("stephenslab/flashr")
help(flashr::flash_add_factors_from_data)
library(flash)
library(flashr)
help("flash_add_factors_from_data")
library(flashier)
help(flash)
help(flash)
help(flash_add_factors_from_data)
source("~/Documents/academic/MASHvFLASH/scratch/mash_flash_prep.R")
help("flash.add.greedy")
source("~/Documents/academic/MASHvFLASH/scratch/mash_flash_prep.R")
library(flashr)
help("flash_add_greedy")
help(flash.add.greedy)
help("flash_add_greedy")
library(flashier)
help(flash)
library(flashr)
help("flash_set_data")
help("flash.add.greedy")
help("flash.init")
help("flash_backfit")
help("flash.backfit")
help(flash.init)
help("flash_add_fixed_loadings")
help(flash.fix.factors)
vignette("advanced", "flashier")
help(flash.fix.factors)
debugSource("~/Documents/academic/MASHvFLASH/scratch/mash_flash_prep.R")
force(data)
View(data)
help("flash.init")
debugSource("~/Documents/academic/MASHvFLASH/scratch/mash_flash_prep.R")
debugSource("~/Documents/academic/MASHvFLASH/scratch/mash_flash_prep.R")
debugSource("~/Documents/academic/MASHvFLASH/scratch/mash_flash_prep.R")
ebnm_fn
help(flash.add.greedy)
debugSource("~/Documents/academic/MASHvFLASH/scratch/mash_flash_prep.R")
debugSource("~/Documents/academic/MASHvFLASH/scratch/mash_flash_prep.R")
debugSource("~/Documents/academic/MASHvFLASH/scratch/mash_flash_prep.R")
zero.res$f
help("flash_add_fixed_loadings")
help("flash.fix.factors")
canonical
help("flash.fix.factors")
zero.res$f
zero.res$f$R2
zero.res$f$verbose.colwidths
flashier::ldf(zero.res$f)
canonical
debugSource("~/Documents/academic/MASHvFLASH/scratch/mash_flash_prep.R")
debugSource("~/Documents/academic/MASHvFLASH/scratch/mash_flash_prep.R")
debugSource("~/Documents/academic/MASHvFLASH/scratch/mash_flash_prep.R")
debugSource("~/Documents/academic/MASHvFLASH/scratch/mash_flash_prep.R")
